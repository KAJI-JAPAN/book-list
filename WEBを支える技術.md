# Webを支える技術

[https://www.amazon.co.jp/Webを支える技術-HTTP、URI、HTML、そしてREST-WEB-PRESS-plus/dp/4774142042](https://www.amazon.co.jp/Web%E3%82%92%E6%94%AF%E3%81%88%E3%82%8B%E6%8A%80%E8%A1%93-HTTP%E3%80%81URI%E3%80%81HTML%E3%80%81%E3%81%9D%E3%81%97%E3%81%A6REST-WEB-PRESS-plus/dp/4774142042)

### Webの概要

- ブラウザを通して天気予報やニュースなど何かしらの情報にwebサーバーを通じてアクセスするものをWebという
    - Webを支える3つの技術
        1. HTTP：通信プロトコル（通信のお決まり）get, post, put, delete, head
        2. URI：URI=URL（URNはほぼ使われないので無視）名前解決などでドメイン名をつける
        3. HTML：文章を表示する言語
- Webはハイパーメディア(リンク)でできている。動画を見るにも画像を見るにも文章を見るにもユーザーが自分で目的のリンクを辿って情報を得る

### RESTとは何か

RESTとは6つのスタイルを組み合わせたもの（アーキテクチャースタイルを組み合わせたもの）

実際の設計では全てを取り入れる必要はなく臨機応変に対応する

- クライアント/サーバー:ユーザーインターフェースの分離（フロントエンド/バックエンド）
- ステートレスサーバー：サーバーでクライアントの状態を管理しない（CookieもRESTにはの則ってない）
- キャッシュ：利点、サーバーとクライアントの通信回数を減らせる
- 統一インターフェース：サーバーとフロントで同じURLに対する操作となること
- 階層化システム：クライアント、サーバー、プロキシ、ロードバランサーなどの階層に分けること。CXRのTVをパッケージ化して分けたのもそういうこと
- コードオンデマンド：webサーバーからクライアントにコードをダウンロードしてページを見る

**※注意**

JavaやRailsなどで作成しているサーバーはアプリケーションサーバーと呼ばれる。RESTで出てくるのはWebサーバーである

- **アプリケーションサーバーの役割**
    - HTTP経由でHTML、CSS、JSを表示する(Apache HTTP Server、Nginx)
    - Webページを提供し、クライアントとサーバー間の通信を管理することです。静的なコンテンツの提供に特化しており、複雑なビジネスロジックやデータベースとの直接的なやり取りは行わない
- **Webサーバーの役割**
    - ビジネスロジックの処理を行い、データベース操作やアプリケーションレベルのサービスを提供するための環境を提供(JavaのTomcat、Railsアプリケーション用のPumaやUnicorn)

このようにお互い違った役割でWebサーバーで処理できない複雑な処理はアプリケーションサーバーが担当する。APサーバーがJavaなどになる

- AWSからの引用
    
    ウェブサーバーは常に新しいリクエストを最初に受信します。情報自体を生成できる場合は、その情報を生成して HTTP レスポンスを送り返します。また、ユーザーが要求したデータがまだキャッシュにないことも確認します。
    
    ウェブサーバーがユーザーが必要とするコンテンツにアクセスできない場合、その要求をアプリケーションサーバーに転送します。
    

![スクリーンショット 2024-01-21 14.38.16.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/65990bf7-7d9a-4919-a9c8-e00d5510d6e8/409ed449-f111-4854-8f17-e42473bdb74b/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2024-01-21_14.38.16.png)

## 第3部 HTTP

- HTTPはステートレスなプロコトル（プロトコル=仕様）
    - ステートフル
        - 全てのやりとりの履歴を残す
    - ステートレス
        - やり取りの履歴がないため、毎回前提のやり取りから共有する
    
    ステートフルの欠点
    
    - 接続が増えると個々のユーザーの状態を保持するのが難しい
    - 同じブラウザに多くのユーザーがアクセスする場合どのユーザーの状態かをサーバー間で共有しておく必要があるためスケールが難しいし
    - 上記の理由からサーバーの負荷も大きくなる

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/65990bf7-7d9a-4919-a9c8-e00d5510d6e8/bd4b7e61-99d3-4825-9de8-effd3b5317ef/Untitled.png)

**ステートレス**

- ステートレスの特徴
    - サーバーが状態を覚えておく代わりに、毎回クライアント側で状態をサーバーに渡すことでサーバーが状態を保持しなくても良くする
    - アクセス数が増えた場合はサーバーを増やすだけで良くスケールも容易

- POSTとPUTの使い分け方
    - 基本的にはPOSTを使用で場合によってはPUTも許容
        - POSTとPUTの使い分け方法
            
            -既存のリソースにサーバー側でデータを追加する場合はPOST
            
            -wikiのように投稿者の投稿がそのままUR Lに含まれる場合はPUT
            
        
        ※しかし、POSTで作成した場合はサーバー側手動でシステムを動かせるので勝手にURLを作成できるが、PUTの場合はユーザーの何かしらの行動でコンピューターリソースのURLを書き換えることになるので基本的にはPOST
        
- GET、POST、DELETEの使い方の注意点
    - 全てのリソースの前提を理解して正しく使用する。GETではリソースに対する変更を行わない。POSTではリソースの更新を行う。DELETEでは時間や状況で変化するようなURLを指定しない